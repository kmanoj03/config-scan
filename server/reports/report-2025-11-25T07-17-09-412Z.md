# Config Scan Report

Scanned At: 2025-11-25T07:17:09.410Z

## File: examples/Dockerfile.bad
Type: docker  
Overall Risk: HIGH (score: 6)

### Findings

- **[HIGH] DOCKER_LATEST_TAG (Line ~1)**  
  Description: Docker image uses the 'latest' tag.  
  Recommendation: Pin a specific version tag instead of 'latest' to ensure reproducible builds.

- **[MEDIUM] DOCKER_MISSING_USER**  
  Description: Dockerfile does not specify a USER and will run as root by default.  
  Recommendation: Add a non-root USER to reduce the impact of a container compromise.

- **[MEDIUM] DOCKER_MISSING_HEALTHCHECK**  
  Description: Dockerfile does not include a HEALTHCHECK instruction.  
  Recommendation: Add a HEALTHCHECK to enable container health monitoring and automatic recovery.

- **[MEDIUM] DOCKER_COPY_DOT_DOT (Line ~4)**  
  Description: Dockerfile uses COPY . . which may include sensitive files.  
  Recommendation: Use specific COPY paths or a .dockerignore file to avoid copying secrets, .git, or build artifacts.

## File: examples/deployment-bad.yaml
Type: kubernetes  
Overall Risk: HIGH (score: 6)

### Findings

- **[HIGH] K8S_PRIVILEGED_CONTAINER**  
  Description: One or more containers are running in privileged mode.  
  Recommendation: Avoid privileged containers; use fine-grained capabilities instead.

- **[MEDIUM] K8S_MISSING_PROBES**  
  Description: No liveness or readiness probes configured.  
  Recommendation: Add probes to enable automatic health checks and recovery.

- **[MEDIUM] K8S_IMAGE_LATEST_TAG (Line ~11)**  
  Description: Container image uses the 'latest' tag.  
  Recommendation: Pin specific image versions instead of 'latest' to ensure consistency.

- **[MEDIUM] K8S_MISSING_READONLY_ROOT_FS**  
  Description: securityContext is present but readOnlyRootFilesystem is not set to true.  
  Recommendation: Set readOnlyRootFilesystem: true to make the container filesystem immutable.

## File: examples/nginx-bad.conf
Type: nginx  
Overall Risk: MEDIUM (score: 5.5)

### Findings

- **[MEDIUM] NGINX_SSL_PROTOCOLS_WEAK_OR_MISSING**  
  Description: TLS is configured without explicitly setting 'ssl_protocols'.  
  Recommendation: Set 'ssl_protocols TLSv1.2 TLSv1.3;' to avoid weak protocols.

- **[MEDIUM] NGINX_SERVER_TOKENS_ON**  
  Description: Nginx is configured with 'server_tokens on', exposing version info.  
  Recommendation: Set 'server_tokens off;' to avoid leaking Nginx version information in responses.

- **[MEDIUM] NGINX_MISSING_X_CONTENT_TYPE_OPTIONS**  
  Description: Missing X-Content-Type-Options security header.  
  Recommendation: Add 'add_header X-Content-Type-Options "nosniff" always;' to prevent MIME-type sniffing.

- **[MEDIUM] NGINX_MISSING_X_FRAME_OPTIONS**  
  Description: Missing X-Frame-Options security header.  
  Recommendation: Add 'add_header X-Frame-Options "SAMEORIGIN" always;' to prevent clickjacking attacks.

- **[LOW] NGINX_CLIENT_MAX_BODY_SIZE**  
  Description: client_max_body_size not explicitly set.  
  Recommendation: Set an appropriate client_max_body_size to prevent abuse (e.g., 10m).

- **[MEDIUM] NGINX_MISSING_HSTS**  
  Description: HTTPS is configured but Strict-Transport-Security (HSTS) header is missing.  
  Recommendation: Add 'add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;' to enforce HTTPS.
