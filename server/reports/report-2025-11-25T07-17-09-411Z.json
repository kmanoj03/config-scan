{
  "files": [
    {
      "path": "examples/Dockerfile.bad",
      "configType": "docker",
      "findings": [
        {
          "id": "DOCKER_LATEST_TAG",
          "configType": "docker",
          "severity": "HIGH",
          "description": "Docker image uses the 'latest' tag.",
          "recommendation": "Pin a specific version tag instead of 'latest' to ensure reproducible builds.",
          "lineHint": 1
        },
        {
          "id": "DOCKER_MISSING_USER",
          "configType": "docker",
          "severity": "MEDIUM",
          "description": "Dockerfile does not specify a USER and will run as root by default.",
          "recommendation": "Add a non-root USER to reduce the impact of a container compromise."
        },
        {
          "id": "DOCKER_MISSING_HEALTHCHECK",
          "configType": "docker",
          "severity": "MEDIUM",
          "description": "Dockerfile does not include a HEALTHCHECK instruction.",
          "recommendation": "Add a HEALTHCHECK to enable container health monitoring and automatic recovery."
        },
        {
          "id": "DOCKER_COPY_DOT_DOT",
          "configType": "docker",
          "severity": "MEDIUM",
          "description": "Dockerfile uses COPY . . which may include sensitive files.",
          "recommendation": "Use specific COPY paths or a .dockerignore file to avoid copying secrets, .git, or build artifacts.",
          "lineHint": 4
        }
      ],
      "overallScore": 6,
      "overallRisk": "HIGH"
    },
    {
      "path": "examples/deployment-bad.yaml",
      "configType": "kubernetes",
      "findings": [
        {
          "id": "K8S_PRIVILEGED_CONTAINER",
          "configType": "kubernetes",
          "severity": "HIGH",
          "description": "One or more containers are running in privileged mode.",
          "recommendation": "Avoid privileged containers; use fine-grained capabilities instead."
        },
        {
          "id": "K8S_MISSING_PROBES",
          "configType": "kubernetes",
          "severity": "MEDIUM",
          "description": "No liveness or readiness probes configured.",
          "recommendation": "Add probes to enable automatic health checks and recovery."
        },
        {
          "id": "K8S_IMAGE_LATEST_TAG",
          "configType": "kubernetes",
          "severity": "MEDIUM",
          "description": "Container image uses the 'latest' tag.",
          "recommendation": "Pin specific image versions instead of 'latest' to ensure consistency.",
          "lineHint": 11
        },
        {
          "id": "K8S_MISSING_READONLY_ROOT_FS",
          "configType": "kubernetes",
          "severity": "MEDIUM",
          "description": "securityContext is present but readOnlyRootFilesystem is not set to true.",
          "recommendation": "Set readOnlyRootFilesystem: true to make the container filesystem immutable."
        }
      ],
      "overallScore": 6,
      "overallRisk": "HIGH"
    },
    {
      "path": "examples/nginx-bad.conf",
      "configType": "nginx",
      "findings": [
        {
          "id": "NGINX_SSL_PROTOCOLS_WEAK_OR_MISSING",
          "configType": "nginx",
          "severity": "MEDIUM",
          "description": "TLS is configured without explicitly setting 'ssl_protocols'.",
          "recommendation": "Set 'ssl_protocols TLSv1.2 TLSv1.3;' to avoid weak protocols."
        },
        {
          "id": "NGINX_SERVER_TOKENS_ON",
          "configType": "nginx",
          "severity": "MEDIUM",
          "description": "Nginx is configured with 'server_tokens on', exposing version info.",
          "recommendation": "Set 'server_tokens off;' to avoid leaking Nginx version information in responses."
        },
        {
          "id": "NGINX_MISSING_X_CONTENT_TYPE_OPTIONS",
          "configType": "nginx",
          "severity": "MEDIUM",
          "description": "Missing X-Content-Type-Options security header.",
          "recommendation": "Add 'add_header X-Content-Type-Options \"nosniff\" always;' to prevent MIME-type sniffing."
        },
        {
          "id": "NGINX_MISSING_X_FRAME_OPTIONS",
          "configType": "nginx",
          "severity": "MEDIUM",
          "description": "Missing X-Frame-Options security header.",
          "recommendation": "Add 'add_header X-Frame-Options \"SAMEORIGIN\" always;' to prevent clickjacking attacks."
        },
        {
          "id": "NGINX_CLIENT_MAX_BODY_SIZE",
          "configType": "nginx",
          "severity": "LOW",
          "description": "client_max_body_size not explicitly set.",
          "recommendation": "Set an appropriate client_max_body_size to prevent abuse (e.g., 10m)."
        },
        {
          "id": "NGINX_MISSING_HSTS",
          "configType": "nginx",
          "severity": "MEDIUM",
          "description": "HTTPS is configured but Strict-Transport-Security (HSTS) header is missing.",
          "recommendation": "Add 'add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains\" always;' to enforce HTTPS."
        }
      ],
      "overallScore": 5.5,
      "overallRisk": "MEDIUM"
    }
  ],
  "scannedAt": "2025-11-25T07:17:09.410Z"
}